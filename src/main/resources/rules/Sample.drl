package com.sample
 
import com.sample.Window;

global Window window;

declare Dialog
	question: String
	answers: String[]
end

declare Answer
	dialog: Dialog
	dialogAnswer: String
end

rule "Init"
	when
	then
		insert(
		new Dialog(
		"Search your feelings. Why are you traveling",
		new String[] {		"Vacation? Now that's a word I haven't heard in a long, long time.",
		"I just want to teleport off this rock"}
		));
		window = new Window();
		insert(window);
end

rule "D"
	when a: Dialog()
	then 
		String odp = window.askUser(a.getQuestion(),a.getAnswers());
		Answer ans = new Answer(a, odp);
		insert(ans);
end

rule "Q2"
	when Answer(
		d: dialog, 
		d.getQuestion() == "Search your feelings. Why are you traveling"
		&& getDialogAnswer() == "Vacation? Now that's a word I haven't heard in a long, long time.")
	then
	Dialog td = new Dialog(
		"What could you use a break from?",
		new String[] {"The same faces at the cantina","The city","Work"});
	String ta = window.askUser(td.getQuestion(),td.getAnswers());
	insert(new Answer (td,ta));
end

rule "Q5"
	when Answer(
		d: dialog, d.getQuestion == "What could you use a break from?" 
		&& getDialogAnswer() == "The same faces at the cantina"
		)
	then 
	Dialog td = new Dialog(
		"Are you self-destructive?",
		 new String[]{"No","Yes"}
		 );
	String ta = window.askUser(td.getQuestion(),td.getAnswers());
	insert(new Answer( td,ta));
end

rule "Q3"
	when Answer(
		d:dialog,d.getQuestion == "What could you use a break from?" &&
		getDialogAnswer() == "The city"
		)
	then
	Dialog td = new Dialog(
		"Sounds like you need to commune with nature.",
		new String[] {"OK but I'm not sleeping outside, rigth","Yes"}
		);
	String ta = window.askUser(td.getQuestion(),td.getAnswers());
	insert(new Answer(td,ta));
end

rule "Q4"
	when Answer(
		d:dialog, d.getQuestion == "What could you use a break from?"
		&& getDialogAnswer() == "Work"
	)
	then
	Dialog tempDialog = new Dialog(
		"What line of work are you in?",
		new String[] {"Business","Retail"}
	);
	String userAnswer = window.askUser(tempDialog.getQuestion(), tempDialog.getAnswers());
	insert(new Answer(tempDialog,userAnswer));
end

rule "Q6"
	when Answer(
		d:dialog, d.getQuestion == "Are you self-destructive?"
		&& getDialogAnswer() == "Yes"
	)
	then
	Dialog tempDialog = new Dialog(
		"Mentally or physically",
		new String[] {"Mentally","Physically"}
	);
	String userAnswer = window.askUser(tempDialog.getQuestion(), tempDialog.getAnswers());
	insert(new Answer(tempDialog,userAnswer));
end

rule "Q7"
	when Answer(
		d:dialog, d.getQuestion == "Are you self-destructive?"
		&& getDialogAnswer() == "No"
	)
	then
	Dialog tempDialog = new Dialog(
		"Are you social?",
		new String[] {"No","Yes","I prefer animals over people"}
	);
	String userAnswer = window.askUser(tempDialog.getQuestion(), tempDialog.getAnswers());
	insert(new Answer(tempDialog,userAnswer));
end

rule "Q8"
	when Answer(
		d:dialog, d.getQuestion == "Are you social?"
		&& getDialogAnswer() == "No"
	)
	then
	Dialog tempDialog = new Dialog(
		"By choice?",
		new String[] {"No, most of my friends have moved away.","Yes. I can't stand pathetic life forms"}
	);
	String userAnswer = window.askUser(tempDialog.getQuestion(), tempDialog.getAnswers());
	insert(new Answer(tempDialog,userAnswer));
end

rule "Q9"
	when Answer(
		d:dialog, d.getQuestion == "By choice?"
		&& getDialogAnswer() == "Yes. I can't stand pathetic life forms"
	)
	then
	Dialog tempDialog = new Dialog(
		"What color is your lightsaber?",
		new String[] {"Blue","Red"}
	);
	String userAnswer = window.askUser(tempDialog.getQuestion(), tempDialog.getAnswers());
	insert(new Answer(tempDialog,userAnswer));
end

rule "Q9_ilum"
	when Answer(
		d:dialog, d.getQuestion == "What color is your lightsaber?"
		&& getDialogAnswer() == "Blue"
	)
	then
	Dialog tempDialog = new Dialog(
		"Your destinations is:\nILUM",
		new String[] {"OK"}
	);
	String userAnswer = window.askUser(tempDialog.getQuestion(), tempDialog.getAnswers());
	insert(new Answer(tempDialog,userAnswer));
end

rule "Q9_jakku"
	when Answer(
		d:dialog, d.getQuestion == "What color is your lightsaber?"
		&& getDialogAnswer() == "Red"
	)
	then
	Dialog tempDialog = new Dialog(
		"Your destinations is:\nJAKKU",
		new String[] {"OK"}
	);
	String userAnswer = window.askUser(tempDialog.getQuestion(), tempDialog.getAnswers());
	insert(new Answer(tempDialog,userAnswer));
end